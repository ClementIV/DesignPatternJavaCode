# 抽象工厂模式

![updated](https://img.shields.io/eclipse-marketplace/last-update/notepad4e.svg)

## 工厂模式问题

工厂模式通过引入工厂等级结构,解决了简单工厂模式中`工厂类职责严重的问题`,但是`工厂方法模式中的每个工厂只生产一类产品`，可能会导致 `系统中存在大量的工厂类,势必会增加系统的开销`

### 解决思路

我们考虑将一些**相关的产品组成一个“产品族”由同一个工厂来统一生产**，这就是抽象工厂模式的思想。

## 抽象工厂模式方法

又称为Kit模式，它是一种对象创建型模式。

### 抽象工厂模式中的角色

* AbstractFactory(抽象工厂)：它声明了一组用于创建一族产品的方法，每一个方法对应一种产品。
* ConcreteFactory(具体工厂)：它实现了在抽象工厂中声明的创建产品的方法，生成一组具体产品，这些产品构成了一个产品族，每个产品都位于某个产品等级结构中。
* AbstractProduct(抽象产品)：它为每种产品声明接口，在抽象产品中声明了产品所具有的业务方法。
* ConcreteProduct(具体产品)：它定义每种产品声明接口，在抽象产品中声明了所具有的的业务方法。

### “开闭原则”倾斜性

* 增加产品族
    * 对于增加新的产品族，抽象工厂模式很友好地支持了“开闭原则”，只需要增加具体产品并增加了一个新的具体工厂，对已有代码无须做任何修改。
* 增加新的产品等级结构
    * 对于增加新的产品等级结构，需要修改所有的工厂角色，包括抽象工厂类，在所有的工厂类中都需要增加生成新产品的方法，违背“开闭原则”
    

## 抽象工厂模式总结

抽象工厂模式是工厂方法模式的进一步延伸，由于它提供了功能更为强大的工厂类并且具备了较好的扩展性，在软件开发中得以广泛应用，尤其是在一些框架和API类库的设计中。

### 主要优点

1. 抽象工厂模式隔离了具体类的生成，使得客户并不需要知道什么被创建，由于这种隔离，更换一个具体工厂就变得相对容易，所有的具体工厂都实现了抽象工厂中定义的那些公共接口，因此只需要改变具体工厂的实例，就可以在某种程度上改变整个软件系统的行为。
2. 当一个产品族的多个对象被设计成一起工作时，它能够保证客户端始终只使用同一个产品族中的对象。
3. 增加新的产品族很方便，无须修改已有系统，符合“开闭原则”

### 主要缺点

增加新的产品等级结构麻烦，需要对原有系统进行较大的修改，甚至需要修改抽象层代码，这显然会带来较大的不便，违背了“开闭原则”

### 适用场景

1. 一个系统不依赖于产品类实例如何被创建，组合和表达的细节，这对于所有类型的工厂模式都很重要，用户无需关心对象的创建和使用解耦

2. 系统中有多个产品族，而每次只使用其中某一个产品族。可以通过配置文件等方式来使得用户可以动态改变产品族，也可以很方便的增加新的产品族。

3. 属于同一产品族的产品将被一起使用，这一约束必须在系统的设计中体现出来。同一个产品族中的产品可以是没有任何关系的对象，但是它们都具有一些共同的约束，

4. 产品等级结构稳定，设计完成之后，不会向系统中增加新的产品等级结构或者删除已有的产品等级结构。